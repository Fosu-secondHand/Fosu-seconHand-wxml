<view class="container">
  <custom-nav-bar title="设置" showBack="true" />
  
  <view style="padding-top: 88rpx;">
    <!-- 头像编辑 -->
    <view class="avatar-section" bindtap="openAvatarEditModal">
      <image class="avatar" src="{{avatarUrl}}" mode="aspectFill"></image>
      <view class="edit-icon">
        <image src="/static/assets/icons/edit.png" mode="aspectFit"></image>
      </view>
    </view>

    <!-- 用户信息列表 -->
    <view class="info-list">
      <!-- 昵称 -->
      <view class="info-item" bindtap="openNicknameEdit">
        <view class="info-label">昵称</view>
        <view class="info-content">
          <text>{{nickname}}</text>
          <image class="arrow-icon" src="/static/assets/icons/arrowright.png" mode="aspectFit"></image>
        </view>
      </view>

      <!-- 账号 -->
      <view class="info-item">
        <view class="info-label">账号</view>
        <view class="info-content">
          <text>{{accountNumber}}</text>
        </view>
      </view>

      <!-- 简介 -->
      <view class="info-item" bindtap="openIntroEdit">
        <view class="info-label">简介</view>
        <view class="info-content">
          <text>{{intro || '未设置简介'}}</text>
          <image class="arrow-icon" src="/static/assets/icons/arrowright.png" mode="aspectFit"></image>
        </view>
      </view>

      <!-- 手机绑定 -->
      <view class="info-item" bindtap="openBindPhone">
        <view class="info-label">手机绑定</view>
        <view class="info-content">
          <text>{{phone || '未绑定手机'}}</text>
          <image class="arrow-icon" src="/static/assets/icons/arrowright.png" mode="aspectFit"></image>
        </view>
      </view>
    </view>

    <!-- 通知设置 -->
    <view class="section-title">通知设置</view>
    <view class="info-list">
    <view class="info-item">
      <view class="info-label">接收通知</view>
      <view class="info-content">
        <switch checked="{{notificationEnabled}}" bindchange="toggleNotification" color="#07c160"/>
      </view>
    </view>
  </view>
</view>

  <!-- 退出登录 -->
  <view class="logout-btn" bindtap="handleLogout">退出登录</view>

  <!-- 头像编辑弹窗 -->
  <view class="modal" wx:if="{{isAvatarEditModalShow}}">
    <view class="modal-mask" bindtap="closeAvatarEditModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text>修改头像</text>
        <image class="close-icon" src="/static/assets/icons/close.png" bindtap="closeAvatarEditModal" mode="aspectFit"></image>
      </view>
      <view class="modal-body">
        <image class="preview-avatar" src="{{tempAvatarUrl}}" mode="aspectFill"></image>
        <button class="upload-btn" bindtap="chooseImage">选择图片</button>
      </view>
      <view class="modal-footer">
        <button class="cancel-btn" bindtap="closeAvatarEditModal">取消</button>
        <button class="confirm-btn" bindtap="uploadAvatar">确定</button>
      </view>
    </view>
  </view>

  <!-- 昵称编辑弹窗 -->
  <view class="modal" wx:if="{{isNicknameEditModalShow}}">
    <view class="modal-mask" bindtap="closeNicknameEditModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text>修改昵称</text>
        <image class="close-icon" src="/static/assets/icons/close.png" bindtap="closeNicknameEditModal" mode="aspectFit"></image>
      </view>
      <view class="modal-body">
        <input class="edit-input" value="{{tempNickname}}" bindinput="onNicknameInput" placeholder="请输入昵称"/>
        <button class="random-btn" bindtap="generateRandomNickname">随机昵称</button>
      </view>
      <view class="modal-footer">
        <button class="cancel-btn" bindtap="closeNicknameEditModal">取消</button>
        <button class="confirm-btn" bindtap="saveNickname">确定</button>
      </view>
    </view>
  </view>

  <!-- 简介编辑弹窗 -->
  <view class="modal" wx:if="{{isIntroEditModalShow}}">
    <view class="modal-mask" bindtap="closeIntroEditModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text>修改简介</text>
        <image class="close-icon" src="/static/assets/icons/close.png" bindtap="closeIntroEditModal" mode="aspectFit"></image>
      </view>
      <view class="modal-body">
        <textarea class="edit-textarea" value="{{tempIntro}}" bindinput="onIntroInput" placeholder="请输入个人简介" maxlength="100"/>
        <view class="word-count">{{tempIntro.length}}/100</view>
      </view>
      <view class="modal-footer">
        <button class="cancel-btn" bindtap="closeIntroEditModal">取消</button>
        <button class="confirm-btn" bindtap="saveIntro">确定</button>
      </view>
    </view>
  </view>

  <!-- 手机绑定弹窗 -->
  <view class="modal" wx:if="{{isBindPhoneModalShow}}">
    <view class="modal-mask" bindtap="closeBindPhoneModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text>绑定手机</text>
        <image class="close-icon" src="/static/assets/icons/close.png" bindtap="closeBindPhoneModal" mode="aspectFit"></image>
      </view>
      <view class="modal-body">
        <input class="edit-input" type="number" value="{{tempPhone}}" bindinput="onPhoneInput" placeholder="请输入手机号" maxlength="11"/>
      </view>
      <view class="modal-footer">
        <button class="cancel-btn" bindtap="closeBindPhoneModal">取消</button>
        <button class="confirm-btn" bindtap="bindPhone">确定</button>
      </view>
    </view>
  </view>
</view>